<!doctype html>
<html>
<head>
    <meta charset="UTF-8">

$include "loadBrowserCSS.ihtml"
$include "loadBrowserScripts.ihtml"

<script>
var messageID;
var handlePanelMessageListenerAdded;

(function () {

    if (! handlePanelMessageListenerAdded) {
        handlePanelMessageListenerAdded = true;
        window.addEventListener('message', handlePanelMessage);
    }

    function handlePanelMessage(event) {

        var messageObj = JSON.parse(event.data);
        $('#panelMessageText').text(messageObj.text);

    }

    function handleImageClick(evt) {
        
        var url = window.location.origin;

        var width = evt.naturalWidth;
        var height = evt.naturalHeight;

        var src = evt.getAttribute('src');

        url += src;

        if (! messageID) {
            messageID = 0;
        }

        messageID++;
        var message = {
            opcode: "insertImage",
            messageID: mnessageID,
            url: url,
            width: width,
            height: height
        };

        var messageJSON = JSON.stringify(message);
        window.top.postMessage(messageJSON, "*");
    }
})();
</script>

</head>
<body>

    <div id="panelMessageText"></div>